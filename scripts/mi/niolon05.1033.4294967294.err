Definition of an electrophysiological dataset
    Dataset composed of 7442 subjects / sessions
    At least 10 subjects / roi required
    Supported MI definition I(x; y (discret)) (cd)
Gaussian Copula Mutual Information Estimator (mi_type=cd, copnorm=False, biascorrect=True, demeaned=False)
Definition of a non-parametric statistical workflow
Workflow for computing mutual information (rfx - cd)
    Evaluate true and permuted mi (n_perm=200, n_jobs=-1)
  0%|          | Estimating MI : 0/81 [00:00<?,       ?it/s]  1%|          | Estimating MI : 1/81 [01:46<2:22:12,  106.66s/it]  2%|▏         | Estimating MI : 2/81 [07:17<2:35:11,  117.86s/it]  4%|▎         | Estimating MI : 3/81 [07:29<2:26:19,  112.56s/it]  5%|▍         | Estimating MI : 4/81 [07:39<2:17:53,  107.45s/it]  6%|▌         | Estimating MI : 5/81 [08:15<2:11:32,  103.85s/it]  7%|▋         | Estimating MI : 6/81 [08:33<2:04:30,   99.60s/it]  9%|▊         | Estimating MI : 7/81 [08:40<1:57:05,   94.94s/it] 10%|▉         | Estimating MI : 8/81 [09:00<1:50:59,   91.22s/it] 11%|█         | Estimating MI : 9/81 [09:15<1:44:50,   87.37s/it] 12%|█▏        | Estimating MI : 10/81 [09:31<1:39:11,   83.83s/it] 14%|█▎        | Estimating MI : 11/81 [10:05<1:34:53,   81.34s/it] 15%|█▍        | Estimating MI : 12/81 [10:31<1:30:20,   78.56s/it] 16%|█▌        | Estimating MI : 13/81 [10:34<1:24:46,   74.81s/it] 17%|█▋        | Estimating MI : 14/81 [10:38<1:19:34,   71.27s/it] 19%|█▊        | Estimating MI : 15/81 [11:04<1:15:52,   68.97s/it] 20%|█▉        | Estimating MI : 16/81 [12:09<1:14:31,   68.79s/it] 21%|██        | Estimating MI : 17/81 [12:52<1:12:00,   67.51s/it] 22%|██▏       | Estimating MI : 18/81 [13:46<1:10:10,   66.83s/it] 23%|██▎       | Estimating MI : 19/81 [14:10<1:06:48,   64.66s/it] 25%|██▍       | Estimating MI : 20/81 [15:30<1:06:32,   65.44s/it] 26%|██▌       | Estimating MI : 21/81 [15:50<1:03:10,   63.17s/it] 27%|██▋       | Estimating MI : 22/81 [16:01<59:34,   60.58s/it]   28%|██▊       | Estimating MI : 23/81 [16:22<56:37,   58.57s/it] 30%|██▉       | Estimating MI : 24/81 [17:03<54:48,   57.69s/it] 31%|███       | Estimating MI : 25/81 [18:15<54:31,   58.43s/it] 32%|███▏      | Estimating MI : 26/81 [18:23<51:14,   55.91s/it] 33%|███▎      | Estimating MI : 27/81 [19:02<49:33,   55.07s/it] 35%|███▍      | Estimating MI : 28/81 [19:53<48:27,   54.86s/it] 36%|███▌      | Estimating MI : 29/81 [20:52<47:41,   55.04s/it] 37%|███▋      | Estimating MI : 30/81 [21:48<46:50,   55.10s/it] 38%|███▊      | Estimating MI : 31/81 [22:22<45:02,   54.04s/it] 40%|███▉      | Estimating MI : 32/81 [23:43<45:14,   55.40s/it] 41%|████      | Estimating MI : 33/81 [24:17<43:27,   54.31s/it] 42%|████▏     | Estimating MI : 34/81 [24:37<41:13,   52.62s/it] 43%|████▎     | Estimating MI : 35/81 [24:46<38:38,   50.41s/it] 44%|████▍     | Estimating MI : 36/81 [25:12<36:53,   49.20s/it] 46%|████▌     | Estimating MI : 37/81 [25:24<34:43,   47.35s/it]exception calling callback for <Future at 0x7f965a1d6100 state=finished raised BrokenProcessPool>
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/process_executor.py", line 404, in _process_worker
    call_item = call_queue.get(block=True, timeout=timeout)
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/numpy_pickle.py", line 524, in load_temporary_memmap
    obj = load(filename, mmap_mode)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/numpy_pickle.py", line 585, in load
    obj = _unpickle(fobj, filename, mmap_mode)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/numpy_pickle.py", line 504, in _unpickle
    obj = unpickler.load()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/pickle.py", line 1210, in load
    raise EOFError
EOFError
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/_base.py", line 625, in _invoke_callbacks
    callback(self)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 359, in __call__
    self.parallel.dispatch_next()
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 792, in dispatch_next
    if not self.dispatch_one_batch(self._original_iterator):
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py", line 531, in apply_async
    future = self._workers.submit(SafeFunction(func))
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/reusable_executor.py", line 177, in submit
    return super(_ReusablePoolExecutor, self).submit(
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/process_executor.py", line 1102, in submit
    raise self._flags.broken
joblib.externals.loky.process_executor.BrokenProcessPool: A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
Exception ignored in: <Finalize object, dead>
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
Exception ignored in: <Finalize object, dead>
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/process_executor.py", line 404, in _process_worker
    call_item = call_queue.get(block=True, timeout=timeout)
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/numpy_pickle.py", line 524, in load_temporary_memmap
    obj = load(filename, mmap_mode)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/numpy_pickle.py", line 585, in load
    obj = _unpickle(fobj, filename, mmap_mode)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/numpy_pickle.py", line 504, in _unpickle
    obj = unpickler.load()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/pickle.py", line 1210, in load
    raise EOFError
EOFError
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/combrisson.e/toolbox/seeg-ebrains/scripts/mi/compute_mi_nodes.py", line 77, in <module>
    mi, pv = wf.fit(ds, mcp=mcp, n_perm=n_perm)
  File "/home/combrisson.e/toolbox/frites/frites/workflow/wf_mi.py", line 235, in fit
    mi, mi_p = self._node_compute_mi(
  File "/home/combrisson.e/toolbox/frites/frites/workflow/wf_mi.py", line 127, in _node_compute_mi
    _mi_p = parallel(p_fun(x, y_p[p], **kw_mi) for p in range(n_perm))
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 1054, in __call__
    self.retrieve()
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 933, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py", line 542, in wrap_future_result
    return future.result(timeout=timeout)
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/_base.py", line 625, in _invoke_callbacks
    callback(self)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 359, in __call__
    self.parallel.dispatch_next()
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 792, in dispatch_next
    if not self.dispatch_one_batch(self._original_iterator):
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py", line 531, in apply_async
    future = self._workers.submit(SafeFunction(func))
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/reusable_executor.py", line 177, in submit
    return super(_ReusablePoolExecutor, self).submit(
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/process_executor.py", line 1102, in submit
    raise self._flags.broken
joblib.externals.loky.process_executor.BrokenProcessPool: A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/combrisson.e/.conda/envs/ecmb_py38/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/combrisson.e/.local/lib/python3.8/site-packages/joblib/externals/loky/backend/synchronize.py", line 96, in _cleanup
    sem_unlink(name)
FileNotFoundError: [Errno 2] No such file or directory
